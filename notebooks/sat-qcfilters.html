
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>plot the QC filter results for satellite DA (cris-fsr &#8212; pyDAmonitor Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/sat-qcfilters';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="matplot pyplot demo" href="matplotlib-pyplot-demo.html" />
    <link rel="prev" title="run a script in a notebook to plot analysis increment profile and vertical cross section" href="script-mpas-increments.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="pyDAmonitor Documentation - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="pyDAmonitor Documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to pyDAmonitor!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">preamble</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../markdown.html">Markdown Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../example.html">notebook example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../markdown-notebooks.html">Notebooks with MyST Markdown</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DA monitor</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="cells.html">Check results and make plots on individual cells</a></li>

<li class="toctree-l1"><a class="reference internal" href="mpas_domain_shape_terrain.html">mpas domain shape and terrain</a></li>
<li class="toctree-l1"><a class="reference internal" href="mpas_plotting.html">mpas-jedi plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="obs_exploring.html">obs exploring</a></li>
<li class="toctree-l1"><a class="reference internal" href="gsi.html">work with GSI</a></li>
<li class="toctree-l1"><a class="reference internal" href="script-mpas-increments.html">script-MPAS analysis increment profile</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">work with satellite observations and filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="matplotlib-pyplot-demo.html">matplotlib-pyplot-demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotly-demo.html">plotly-demo</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/NOAA-GSL/pyDAmonitor" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/NOAA-GSL/pyDAmonitor/issues/new?title=Issue%20on%20page%20%2Fnotebooks/sat-qcfilters.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/sat-qcfilters.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>plot the QC filter results for satellite DA (cris-fsr</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-the-pydamonitor-root-env-variable">get the <code class="docutils literal notranslate"><span class="pre">pyDAmonitor_ROOT</span></code> env variable</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-modules">import modules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-satellite-diagnostics-using-the-obsspace-class">read satellite diagnostics using the <code class="docutils literal notranslate"><span class="pre">obsSpace</span></code> class</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#check-attributes-dimensions-and-the-bt-data-dictionary">check attributes, dimensions and the ‘bt’ data dictionary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-channels-with-valid-ombg-masked-by-clouddetectminresidualir-1">find channels with valid ombg masked by CloudDetectMinResidualIR==1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-sat-obs-map-function">Define the sat_obs_map(..) function</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-a-slidebar-to-quickly-navigate-through-all-channels">Use a slidebar to quickly navigate through all channels</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="plot-the-qc-filter-results-for-satellite-da-cris-fsr">
<h1>plot the QC filter results for satellite DA (cris-fsr<a class="headerlink" href="#plot-the-qc-filter-results-for-satellite-da-cris-fsr" title="Link to this heading">#</a></h1>
<p>Adapted from Haidao Lin’s script</p>
<section id="get-the-pydamonitor-root-env-variable">
<h2>get the <code class="docutils literal notranslate"><span class="pre">pyDAmonitor_ROOT</span></code> env variable<a class="headerlink" href="#get-the-pydamonitor-root-env-variable" title="Link to this heading">#</a></h2>
<p>This step is highly recommended. It is required if one want to use the DAmonitor Python package or use the MPAS/FV3 sample data or local cartopy nature_earth_data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="c1"># autoload external python modules if they changed</span>
<span class="o">%</span><span class="n">load_ext</span> <span class="n">autoreload</span>
<span class="o">%</span><span class="n">autoreload</span> <span class="mi">2</span>
    
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span><span class="o">,</span><span class="w"> </span><span class="nn">os</span>
<span class="n">pyDAmonitor_ROOT</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;pyDAmonitor_ROOT&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">pyDAmonitor_ROOT</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;!!! pyDAmonitor_ROOT is NOT set. Run `source ush/load_pyDAmonitor.sh`&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pyDAmonitor_ROOT=</span><span class="si">{</span><span class="n">pyDAmonitor_ROOT</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pyDAmonitor_ROOT</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pyDAmonitor_ROOT=/home/Guoqing.Ge/pyDAmonitor

CPU times: user 14 ms, sys: 62.8 ms, total: 76.8 ms
Wall time: 114 ms
</pre></div>
</div>
</div>
</div>
</section>
<section id="import-modules">
<h2>import modules<a class="headerlink" href="#import-modules" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">netCDF4</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy</span>
<span class="n">cartopy</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;data_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">pyDAmonitor_ROOT</span><span class="si">}</span><span class="s2">/data/natural_earth_data&quot;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.ticker</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mticker</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="c1">#matplotlib.use(&quot;Agg&quot;)</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">DAmonitor.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">query_data</span><span class="p">,</span> <span class="n">query_dataset</span><span class="p">,</span> <span class="n">query_obj</span><span class="p">,</span> <span class="n">to_dataframe</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">DAmonitor.obs</span><span class="w"> </span><span class="kn">import</span> <span class="n">obsSpace</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 402 ms, sys: 251 ms, total: 654 ms
Wall time: 814 ms
</pre></div>
</div>
</div>
</div>
</section>
<section id="read-satellite-diagnostics-using-the-obsspace-class">
<h2>read satellite diagnostics using the <code class="docutils literal notranslate"><span class="pre">obsSpace</span></code> class<a class="headerlink" href="#read-satellite-diagnostics-using-the-obsspace-class" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">obsfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pyDAmonitor_ROOT</span><span class="p">,</span><span class="s1">&#39;data/mpasjedi/jdiag_cris-fsr_n20.nc&#39;</span><span class="p">)</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">obsSpace</span><span class="p">(</span><span class="n">obsfile</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3.16 s, sys: 5.18 s, total: 8.35 s
Wall time: 8.65 s
</pre></div>
</div>
</div>
</div>
</section>
<section id="check-attributes-dimensions-and-the-bt-data-dictionary">
<h2>check attributes, dimensions and the ‘bt’ data dictionary<a class="headerlink" href="#check-attributes-dimensions-and-the-bt-data-dictionary" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">obs</span><span class="o">.</span><span class="n">ds</span><span class="o">.</span><span class="n">ncattrs</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">obs</span><span class="o">.</span><span class="n">ds</span><span class="o">.</span><span class="n">getncattr</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">obs</span><span class="o">.</span><span class="n">ds</span><span class="o">.</span><span class="n">dimensions</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>converter: BUFR
platformCommonName: CRIS
_ioda_layout_version: 0
sourceFiles: gdas.t00z.crisf4.tm00.bufr_d
datetimeReference: 2021-08-01T00:00:00Z
source: MTYP 021-206 CrIS FULL SPCTRL RADIANCE  (431 CHN SUBSET)
sensor: CrIS
_ioda_layout: ObsGroup
platformLongDescription: JPSS Polar System in sunsynchronous orbit
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Channel&#39;: &quot;&lt;class &#39;netCDF4.Dimension&#39;&gt;&quot;: name = &#39;Channel&#39;, size = 431,
 &#39;Location&#39;: &quot;&lt;class &#39;netCDF4.Dimension&#39;&gt;&quot; (unlimited): name = &#39;Location&#39;, size = 92878}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_data</span><span class="p">(</span><span class="n">obs</span><span class="o">.</span><span class="n">bt</span><span class="p">,</span> <span class="n">meta_exclude</span><span class="o">=</span><span class="s2">&quot;sensorCentralWavenumber_&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DerivedObsError, DerivedObsValue, CloudDetectMinResidualIR, NearSSTRetCheckIR, ScanEdgeRemoval, GrossCheck, Thinning, UseflagCheck, EffectiveError0, EffectiveError1, EffectiveError2, EffectiveQC0, EffectiveQC1, EffectiveQC2, sensorZenithAngle, satelliteIdentifier, sensorScanPosition, instrumentIdentifier, longitude, latitude, sensorViewAngle, scanLineNumber, solarZenithAngle, sensorChannelNumber, sensorAzimuthAngle, fieldOfViewNumber, dateTime, solarAzimuthAngle, ObsBias0, ObsBias1, ObsBias2, constantPredictor, emissivityJacobianPredictor, hofx0, hofx1, hofx2, innov1, lapseRatePredictor, lapseRate_order_2Predictor, oman, ombg, sensorScanAnglePredictor, sensorScanAngle_order_2Predictor, sensorScanAngle_order_3Predictor, sensorScanAngle_order_4Predictor, Channel, Location
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obs</span><span class="o">.</span><span class="n">bt</span><span class="o">.</span><span class="n">CloudDetectMinResidualIR</span><span class="o">.</span><span class="n">compressed</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1, 1, 1, ..., 1, 1, 1], shape=(304246,), dtype=int8)
</pre></div>
</div>
</div>
</div>
</section>
<section id="find-channels-with-valid-ombg-masked-by-clouddetectminresidualir-1">
<h2>find channels with valid ombg masked by CloudDetectMinResidualIR==1<a class="headerlink" href="#find-channels-with-valid-ombg-masked-by-clouddetectminresidualir-1" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MAX_LINES</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">knt</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">iChan</span><span class="p">,</span> <span class="n">chanID</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">obs</span><span class="o">.</span><span class="n">bt</span><span class="o">.</span><span class="n">Channel</span><span class="p">):</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">obs</span><span class="o">.</span><span class="n">bt</span><span class="o">.</span><span class="n">CloudDetectMinResidualIR</span><span class="p">[:,</span> <span class="n">iChan</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">obs</span><span class="o">.</span><span class="n">bt</span><span class="o">.</span><span class="n">ombg</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="n">iChan</span><span class="p">]</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">knt</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">knt</span> <span class="o">&lt;=</span> <span class="n">MAX_LINES</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">iChan</span><span class="p">,</span> <span class="n">chanID</span><span class="p">,</span> <span class="n">obs</span><span class="o">.</span><span class="n">bt</span><span class="o">.</span><span class="n">ombg</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="n">iChan</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>  <span class="c1">#  250 648 1083</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>23 59 2
25 61 7
26 62 16
27 63 7
28 64 27
29 65 23
30 66 39
31 67 56
32 68 43
33 69 87
34 70 87
35 71 100
36 72 129
37 73 115
38 74 148
39 75 150
40 76 148
41 77 184
42 78 167
43 79 190
</pre></div>
</div>
</div>
</div>
</section>
<section id="define-the-sat-obs-map-function">
<h2>Define the sat_obs_map(..) function<a class="headerlink" href="#define-the-sat-obs-map-function" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">sat_obs_map</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span><span class="n">iChan</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">qcfilters</span><span class="p">):</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
    
    <span class="c1"># Plot grid lines</span>
    <span class="c1"># ----------------</span>
    <span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                      <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">top_labels</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">xlabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">}</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">ylabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">}</span>
    <span class="c1"># gl.xlocator = mticker.FixedLocator(</span>
        <span class="c1"># [-180, -135, -90, -45, 0, 45, 90, 135, 179.9])</span>

    <span class="n">qcfilterList</span> <span class="o">=</span> <span class="n">qcfilters</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="n">colorList</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">qcfilter</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">qcfilterList</span><span class="p">,</span> <span class="n">colorList</span><span class="p">):</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">obs</span><span class="o">.</span><span class="n">bt</span><span class="p">[</span><span class="n">qcfilter</span><span class="p">][:,</span> <span class="n">iChan</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">obs</span><span class="o">.</span><span class="n">bt</span><span class="o">.</span><span class="n">ombg</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="n">iChan</span><span class="p">]</span>
        <span class="n">lon</span> <span class="o">=</span> <span class="n">obs</span><span class="o">.</span><span class="n">bt</span><span class="o">.</span><span class="n">longitude</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
        <span class="n">lat</span> <span class="o">=</span> <span class="n">obs</span><span class="o">.</span><span class="n">bt</span><span class="o">.</span><span class="n">latitude</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
        <span class="n">knt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> 
                        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">qcfilter</span><span class="si">}</span><span class="s2">, Total Count: </span><span class="si">{</span><span class="n">knt</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">antialiased</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
    <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">(</span><span class="n">area</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">qcfilter</span><span class="si">}</span><span class="s2">, Total Count: </span><span class="si">{</span><span class="n">knt</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iChan</span> <span class="o">=</span> <span class="mi">250</span>
<span class="n">area</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">55</span><span class="p">]</span>

<span class="c1">#</span>
<span class="n">colors</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span>
<span class="n">qcfilters</span> <span class="o">=</span> <span class="s2">&quot;CloudDetectMinResidualIR&quot;</span>
<span class="n">sat_obs_map</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">iChan</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">qcfilters</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">colors</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span>
<span class="n">qcfilters</span> <span class="o">=</span> <span class="s2">&quot;GrossCheck&quot;</span>
<span class="n">sat_obs_map</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">iChan</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">qcfilters</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># plot CloudDetectMinResidualIR and GrossCheck together</span>
<span class="n">colors</span> <span class="o">=</span> <span class="s2">&quot;blue,red&quot;</span>
<span class="n">qcfilters</span> <span class="o">=</span> <span class="s2">&quot;CloudDetectMinResidualIR,GrossCheck&quot;</span>
<span class="n">qcfilters</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">sat_obs_map</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">iChan</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">qcfilters</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">colors</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span>
<span class="n">qcfilters</span> <span class="o">=</span> <span class="s2">&quot;NearSSTRetCheckIR&quot;</span>
<span class="n">sat_obs_map</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">iChan</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">qcfilters</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">colors</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span>
<span class="n">qcfilters</span> <span class="o">=</span> <span class="s2">&quot;UseflagCheck&quot;</span>
<span class="n">sat_obs_map</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">iChan</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">qcfilters</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9010d1838dc50e03b4f20d1eff1bfdb5fd451d7597d78d27338a424573207ea5.png" src="../_images/9010d1838dc50e03b4f20d1eff1bfdb5fd451d7597d78d27338a424573207ea5.png" />
<img alt="../_images/420b0632083b994141eb113d6d17f2bc3bcb1873f31ce5bc8c9922dec5886cae.png" src="../_images/420b0632083b994141eb113d6d17f2bc3bcb1873f31ce5bc8c9922dec5886cae.png" />
<img alt="../_images/e9e27fe967c948b2e226b155c22040bd75e036ca092199ec8dfb11395f821e4d.png" src="../_images/e9e27fe967c948b2e226b155c22040bd75e036ca092199ec8dfb11395f821e4d.png" />
<img alt="../_images/ce961599dcae4a734d9a7a6c2ba1fe91266c8303644f36fcba58fa27d5330beb.png" src="../_images/ce961599dcae4a734d9a7a6c2ba1fe91266c8303644f36fcba58fa27d5330beb.png" />
<img alt="../_images/262152d2fa3ce25938832b7d240659e419f16999f84df121b2e14f4acd17c1a3.png" src="../_images/262152d2fa3ce25938832b7d240659e419f16999f84df121b2e14f4acd17c1a3.png" />
</div>
</div>
</section>
<section id="use-a-slidebar-to-quickly-navigate-through-all-channels">
<h2>Use a slidebar to quickly navigate through all channels<a class="headerlink" href="#use-a-slidebar-to-quickly-navigate-through-all-channels" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">plotly.graph_objects</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">go</span>

<span class="c1"># </span>
<span class="n">qcfilter</span> <span class="o">=</span> <span class="s2">&quot;CloudDetectMinResidualIR&quot;</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">iChan</span><span class="p">,</span> <span class="n">ch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">obs</span><span class="o">.</span><span class="n">bt</span><span class="o">.</span><span class="n">Channel</span><span class="p">):</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">obs</span><span class="o">.</span><span class="n">bt</span><span class="p">[</span><span class="n">qcfilter</span><span class="p">][:,</span> <span class="n">iChan</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="n">field</span> <span class="o">=</span> <span class="n">obs</span><span class="o">.</span><span class="n">bt</span><span class="o">.</span><span class="n">ombg</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="n">iChan</span><span class="p">]</span>
    <span class="n">lon</span> <span class="o">=</span> <span class="n">obs</span><span class="o">.</span><span class="n">bt</span><span class="o">.</span><span class="n">longitude</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">lat</span> <span class="o">=</span> <span class="n">obs</span><span class="o">.</span><span class="n">bt</span><span class="o">.</span><span class="n">latitude</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">knt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ch</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="n">lat</span><span class="p">,</span>
        <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="n">lon</span><span class="p">,</span>
        <span class="s2">&quot;knt&quot;</span><span class="p">:</span> <span class="n">knt</span><span class="p">,</span>
    <span class="p">}</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="c1"># Add initial trace (first channel)</span>
<span class="n">ch0</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">obs</span><span class="o">.</span><span class="n">bt</span><span class="o">.</span><span class="n">Channel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scattermap</span><span class="p">(</span>
    <span class="n">lat</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">ch0</span><span class="p">][</span><span class="s2">&quot;lat&quot;</span><span class="p">],</span>
    <span class="n">lon</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">ch0</span><span class="p">][</span><span class="s2">&quot;lon&quot;</span><span class="p">],</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="n">ch0</span>
<span class="p">))</span>

<span class="c1"># Define slider steps to replace data</span>
<span class="n">steps</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="n">step</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;update&quot;</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">ch</span><span class="p">][</span><span class="s2">&quot;lat&quot;</span><span class="p">]],</span> <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">ch</span><span class="p">][</span><span class="s2">&quot;lon&quot;</span><span class="p">]],</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">ch</span><span class="p">},</span>
              <span class="p">{</span><span class="s2">&quot;title.text&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Channel: </span><span class="si">{</span><span class="n">ch</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">},],</span>
        <span class="n">label</span><span class="o">=</span><span class="n">ch</span>
    <span class="p">)</span>
    <span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>

<span class="n">sliders</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="n">active</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;t&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">},</span> <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">)]</span>

<span class="c1"># Layout</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="nb">map</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">center</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="mf">36.5</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">118</span><span class="p">},</span>  <span class="c1"># adjust for your data</span>
        <span class="n">zoom</span><span class="o">=</span><span class="mi">4</span>
    <span class="p">),</span>
    <span class="n">sliders</span><span class="o">=</span><span class="n">sliders</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>   <span class="c1"># pixels</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>   <span class="c1"># pixels</span>
<span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 1.95 s, sys: 153 ms, total: 2.1 s
Wall time: 2.16 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_dataset</span><span class="p">(</span><span class="n">obs</span><span class="o">.</span><span class="n">ds</span><span class="p">,</span> <span class="n">meta_exclude</span><span class="o">=</span><span class="s2">&quot;sensorCentralWavenumber&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DerivedObsError
    brightnessTemperature, radiance
DerivedObsValue
    brightnessTemperature
DiagnosticFlags
    CloudDetectMinResidualIR
        brightnessTemperature
    NearSSTRetCheckIR
        brightnessTemperature
    ScanEdgeRemoval
        brightnessTemperature
    GrossCheck
        brightnessTemperature
    Thinning
        brightnessTemperature
    UseflagCheck
        brightnessTemperature
EffectiveError0
    brightnessTemperature, radiance
EffectiveError1
    brightnessTemperature, radiance
EffectiveError2
    brightnessTemperature, radiance
EffectiveQC0
    brightnessTemperature, radiance
EffectiveQC1
    brightnessTemperature, radiance
EffectiveQC2
    brightnessTemperature, radiance
MetaData
    sensorZenithAngle, satelliteIdentifier, sensorScanPosition, instrumentIdentifier, longitude, latitude, sensorViewAngle, scanLineNumber, solarZenithAngle, sensorChannelNumber, sensorAzimuthAngle, fieldOfViewNumber, dateTime, solarAzimuthAngle
ObsBias0
    brightnessTemperature
ObsBias1
    brightnessTemperature
ObsBias2
    brightnessTemperature
ObsValue
    radiance
ObsValueAdj
    radiance
constantPredictor
    brightnessTemperature
emissivityJacobianPredictor
    brightnessTemperature
hofx0
    brightnessTemperature
hofx1
    brightnessTemperature
hofx2
    brightnessTemperature
innov1
    brightnessTemperature
lapseRatePredictor
    brightnessTemperature
lapseRate_order_2Predictor
    brightnessTemperature
oman
    brightnessTemperature
ombg
    brightnessTemperature
sensorScanAnglePredictor
    brightnessTemperature
sensorScanAngle_order_2Predictor
    brightnessTemperature
sensorScanAngle_order_3Predictor
    brightnessTemperature
sensorScanAngle_order_4Predictor
    brightnessTemperature
Channel, Location
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "pydamonitor"
        },
        kernelOptions: {
            name: "pydamonitor",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'pydamonitor'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="script-mpas-increments.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">run a script in a notebook to plot analysis increment profile and vertical cross section</p>
      </div>
    </a>
    <a class="right-next"
       href="matplotlib-pyplot-demo.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">matplot pyplot demo</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-the-pydamonitor-root-env-variable">get the <code class="docutils literal notranslate"><span class="pre">pyDAmonitor_ROOT</span></code> env variable</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-modules">import modules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-satellite-diagnostics-using-the-obsspace-class">read satellite diagnostics using the <code class="docutils literal notranslate"><span class="pre">obsSpace</span></code> class</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#check-attributes-dimensions-and-the-bt-data-dictionary">check attributes, dimensions and the ‘bt’ data dictionary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-channels-with-valid-ombg-masked-by-clouddetectminresidualir-1">find channels with valid ombg masked by CloudDetectMinResidualIR==1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-sat-obs-map-function">Define the sat_obs_map(..) function</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-a-slidebar-to-quickly-navigate-through-all-channels">Use a slidebar to quickly navigate through all channels</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The pyDAmonitor group
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>